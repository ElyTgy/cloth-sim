#TODO: move reduction sum here